import{r}from"./vendor.b8d440aa.js";import{d as l}from"./index.ec7c7b74.js";import{j as c,a as n}from"./jsx-runtime.e00ef341.js";import"./index.6ad870be.js";const p="_item_1myu0_1",h="_done_1myu0_12",m="_input_1myu0_16",x="_buttons_1myu0_28";var d={item:p,done:h,input:m,buttons:x};const g=({todo:t,reload:s})=>{const[i,a]=r.exports.useState({text:t.text,editing:!1});async function o(e){await fetch(`/api/todo/${t.id}`,{method:"PATCH",headers:{"content-type":"application/json"},body:JSON.stringify({...t,...e})}),s()}return c("li",{className:d.item,children:[!i.editing&&c("label",{children:[n("input",{type:"checkbox",checked:t.done,onChange:e=>o({done:e.target.checked})})," ",n("span",{className:t.done?d.done:void 0,children:t.text})," "]}),i.editing&&n("input",{className:d.input,autoFocus:!0,value:i.text,onChange:e=>a({text:e.target.value,editing:!0}),onKeyDown:e=>{e.key==="Enter"?(a({text:t.text,editing:!1}),o({text:i.text})):e.key==="Escape"&&a({text:t.text,editing:!1})}}),c("span",{className:d.buttons,children:[!t.done&&!i.editing&&n("button",{type:"button",onClick:()=>a({text:t.text,editing:!0}),children:"Edit"}),t.done&&n("button",{type:"button",onClick:async()=>{await fetch(`/api/todo/${t.id}`,{method:"DELETE"}),s()},children:"Delete"}),i.editing&&i.text!==t.text&&n("button",{type:"button",onClick:async()=>{a({text:t.text,editing:!1}),o({text:i.text})},children:"Save"}),i.editing&&n("button",{type:"button",onClick:()=>a({text:t.text,editing:!1}),children:"Cancel"})]})]},t.id)},b="_todoList_1b1gs_1",f="_addButton_1b1gs_5",y="_p_1b1gs_21",_="_input_1b1gs_25";var u={todoList:b,addButton:f,p:y,input:_},N=l({async load({fetch:t}){return await t("/api/todo").then(async s=>s.ok?{data:await s.json()}:{status:s.status,error:{message:"Failed to fetch todos"}})},Component({data:t,reload:s,useReload:i}){i({focus:!0,reconnect:!0});const[a,o]=r.exports.useState("");return c("main",{children:[n("h1",{children:"Todo"}),n("p",{children:"This is a simple TODO application that demonstrates data fetching."}),n("ul",{className:u.todoList,children:t.map(e=>n(g,{todo:e,reload:s},e.id))}),c("p",{className:u.p,children:[n("input",{className:u.input,value:a,onChange:e=>o(e.target.value)}),n("button",{type:"button",className:u.addButton,disabled:!a,onClick:async()=>{await fetch("/api/todo",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({text:a,done:!1})}),s()},children:"Add"})]})]})}});export{N as default};
